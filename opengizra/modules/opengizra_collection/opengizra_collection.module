<?php
/**
 * @file
 * Code for the Opengizra collection feature.
 */

include_once 'opengizra_collection.features.inc';

/**
 * Implements hook_flag().
 *
 * Trim "Active Collection" flag, so there's only a single flagged
 * content.
 */
function opengizra_collection_flag($action, $flag, $content_id, $account) {
  if ($flag->name != 'active_collection' || $action != 'flag') {
    return;
  }

  flag_trim_flag($flag, $account, 1);
}

/**
 * Implements hook_init().
 *
 * Redriect user to the active collection.
 */
function opengizra_collection_init() {
  if (!drupal_is_cli() && drupal_is_front_page() && $flaggings = flag_get_flagged_content('active_collection')) {
    drupal_goto('node/' . $flaggings[0]->content_id);
  }
}
